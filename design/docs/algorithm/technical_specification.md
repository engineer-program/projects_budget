# Наименование проекта

Плагин для учёта финансов по проектам и сотрудникам компании

## Цель проекта

Реализовать плагин для Easy Redmine для учёта финансов по проектам и сотрудникам компании

## Исходная информация

* веб-приложение системы контроля и управления проектами Easy Redmine 2018.1.1;
* база данных MySQL 5.7.

## Что нужно сделать

Реализация полноценного финансового плагина. Доступ к основным настройкам и просмотру информации в отдельной вкладке "Финансы" в меню "Прочее" в веб-версии Easy Redmine. Необходимо предусмотреть наличие доступа в зависимости от роли пользователя.
Должно открываться главное окно (З/П и премии сотрудников), где справа сверху будет несколько кнопок, при нажатии на которые будет открываться соответствующее окно:

* З/П и премии сотрудников (оно же главное окно);
* финансы проектов;
* сводка финансов;
* статистика.

### Страница "З/П и премии сотрудников"

Представляет собой [страницу](https://www.figma.com/design/InItq3Ywyfz5n2juZiQldq/Finance-projects-Redmine-Plugin?node-id=16-196&m=dev&t=bG8mUnVZt1Aa8s0Z-1) с информацией в табличном виде, где показываются реальные (расчётные) заработные платы и премии по сотрудникам за текущий календарный год по месяцам.
Данный промежуток времени выбран по умолчанию.
Список сотрудников отфильрован по группе "ТКЗ ИЦ СПб" и отсортирован в алфавитном порядке по фамилии.
В таблице можно отфильтровать по дате (текущий календарный год по умолчанию), упорядочить и отфильтровать список сотрудников по:

* фамилии;
* имени;
* должности;
* группа.

Сама таблица на этой странице является нередактируемой.
![Таблица з/п и премий сотрудников](/docs/table_salaries_bonuses_employees.png)
Значения в таблице з/п сотрудника являются расчётными:

* для сотрудников на полной ставке - реальная указанная з/п на руки за месяц вне зависимости от отработанных часов;
* для сотрудников на неполной ставке - посчитанная з/п на руки за месяц с учётом отработанных часов, она рассчитывается таким образом: з/п (ставка) на руки делится на кол-во рабочих часов в месяце и умножается на кол-во отработанных часов за этот месяц.

Значения премий сотрудников отображаются ровно такими, какими их вводят на другой странице (о ней ниже).
Последним столбцом в таблице является средний доход сотрудника в месяц за показываемый период времени, который автоматически рассчитывается: сумма всех реальных з/п и премий за этот промежуток разделить на кол-во месяцев данного временного промежутка.

Для этой страницы дополнительно справа есть кнопка:

* Редактировать таблицу З/П и премий.

При нажатии на кнопку "Редактировать таблицу З/П и премий" открывается [страница "Номинальные заработные платы и премии сотрудников на руки"](https://www.figma.com/design/InItq3Ywyfz5n2juZiQldq/Finance-projects-Redmine-Plugin?node-id=169-2).

### Страница "Номинальные заработные платы и премии сотрудников на руки"

Данная страница уже представляет собой редактируемую таблицу з/п на руки в месяц и премий на руки за месяц.
Фильтры и сортировки в таблице сохраняются как на предыдущей странице; есть возможность их изменения.
Каждое значение з/п и премии можно редактировать вручную.
Однако в таблице значения з/п по месяцам заполняются автоматически, когда наступает каждый новый месяц. Например, на момент 31 января в таблице заполнена з/п за январь; при наступлении 1 февраля последняя указанная сумма з/п сотрудника за январь месяц автоматически записывается на з/п за февраль.
![Редактируемая таблица з/п и премий сотрудников](/docs/edit_table_salaries_bonuses_employees.png)
Столбец "Средний доход за данный период" отсутствует.
Значения з/п для тех, кто на полной ставке и на неполной ставке, указываются такие, словно сотрудник работает на полной ставке.
Для этой страницы дополнительно справа есть кнопка:

* Сохранить.

### Страница "Финансы проектов"

Представляет собой [страницу](https://www.figma.com/design/InItq3Ywyfz5n2juZiQldq/Finance-projects-Redmine-Plugin?node-id=48-2) с информацией в табличном виде, где показываются в первую очередь бюджет и выделенные части на премии сотрудникам.
В таблице можно отфильтровать, упорядочить значения списка проектов и выбрать период, за который рассматриваются данные финансов.
В настройках можно выбрать какие столбцы будут показываться в таблице (номер проекта, проект, бюджет проекта, выделенные премии сотрудникам и т.п.)
Справа расположены кнопки действий:

* Добавить новый расход на премии;
* Добавить новый доход проекта.

При нажатии на кнопку "Добавить новый расход на премии" поверх открывается [всплывающее окно](https://www.figma.com/design/InItq3Ywyfz5n2juZiQldq/Finance-projects-Redmine-Plugin?node-id=109-2).
В нём задаётся:

* дата выделения статьи расхода на премии - обязательное поле;
* выбор проекта, из бюджета которого вычитаем данный расход - обязательное поле;
* в описании можно оставить комментарий - не обязательное поле;
* выделенная сумма расхода на премии - обязательное поле.

### Страница "Сводка финансов"

В разработке..

### Страница "Статистика"

В разработке..

 $$ПРАВКИ:$$

Добавлять скрины сюда + ссылки.

Стартовая страница - З/П и премии сотрудников.
Будет в виде нередактируемой таблицы з/п и премий сотрудников - реально посчитанные по месяцам данные для тех кто на полной ставке и тех, кто на полставке.
Нажимаем кнопку редактировать и переходим в режим изменения данных заработных плат и премий сотрудников по месяцам за календарный год. Тут открывается данная таблица, но в режиме редактирования.
Список сотрудников в алфавитном порядке по умолчанию.
Нужна возможность фильтрации по группам, по отдельным сотрудникам и т.п.
В таблице можем редактировать значения з/п за месяц вручную. Однако на каждый следующий месяц автоматом переносятся все з/п с предыдущего месяца. Можем редачить значение, нажимаем на значок сохранения рядом и значение сохраняется.
Для тех, кто на неполной ставке, в таблицу вносим значения номинальной з/п при отработке как по полной ставке. А уже в нередактируемой таблице будет показываться именно расчётная з/п сотрудника на неполной ставке с учётом количества отработанных часов: полная з/п (ставка) делим на кол-во рабочих часов и умножаем на реальные часы.
Последний столбец - средний доход за данный период (в зависимости от просматриваемого периода времени).

Справа уже несколько кнопок:

* главная страница
* редактирование зарплат и премий сотрудников

Третья кнопка - проекты (зп и премии).
Открывается нередактируемая таблица на календарный год.
Столбцы - проект, бюджет стартовый, бюджет на данный момент, зп, премия за январь, зп, премия за февраль и т.д.
Нужна фильтрация списка проектов по различным полям.
Столбцы ЗП будут считаться автоматически в зависимости от затраченного времени сотрудника на проекте и его з/п - нельзя редачить.
Справа будут кнопки:

* редактировать таблицу - жмём её. Бюджет на начало задается в таблице или редактируется. Внизу таблицы считается автоматически суммарные траты на з/п сотрудникам по всем показанным проектам за каждый месяц;
* добавить доход в бюджет - жмём её - появляется окно, где выбираем проект, вводим сумму, дату начисления, описание дохода;
* добавить расход бюджета - жмём её - появляется окно, где выбираем проект, вводим сумму, дату списания, описание расхода;

Жмем сохранить и переоткрывается эта таблица нередактируемая. За каждый месяц по три столбца: бюджет на начало месяца, з/п за месяц и премии за месяц, выделенные на сотрудников в каждом проекте. Последний столбец таблицы - суммарный остаток бюджет на конец указанного временного промежутка (календарный год по умолчанию).
Для головных проектов показывать в каждом выше указанном столбце должны быть суммарные траты всех подпроектов.
Мы можем смотреть ее и делать выгрузку в xlsx.

Будет фильтр для формирования табеля на сотрудников для бухгалтерии (для упрощения работы ОМ) с возможностью выгрузки в xlsx.

Корректировки по людям, у кого банкротство, будем редактировать в Excel и в Redmine никак не учитывать.

Для каждой таблицы нужна возможность экспорта в xlsx, pdf.

ОХР и ОПР пока отложим на попозже.
Статистика по людям по росту зарплаты - таблица человек - год и средняя з/п за год за несколько лет.

Вопрос с визуализацей главного проекта и подсчёта бюджета главного проекта и списаний менеджеров.
